group_by(CLUSTER_ID) %>%
slice_min(distance, n = 1, with_ties = FALSE) %>%
rename(distance_nh = distance),
by = "CLUSTER_ID"
) %>%
# 2. Join minimum SH distance (already has CLUSTER_ID)
left_join(
sh_distance %>%
group_by(CLUSTER_ID) %>%
slice_min(distance, n = 1, with_ties = FALSE) %>%
rename(distance_sh = distance),
by = "CLUSTER_ID"
) %>%
# 3. Join minimum NH network cost (using origin_id)
left_join(
nh_network %>%
group_by(origin_id) %>%
slice_min(total_cost, n = 1, with_ties = FALSE) %>%
rename(network_nh = total_cost),
by = c("CLUSTER_ID" = "origin_id")
) %>%
# 4. Join minimum SH network cost (using origin_id)
left_join(
sh_network %>%
group_by(origin_id) %>%
slice_min(total_cost, n = 1, with_ties = FALSE) %>%
rename(network_sh = total_cost),
by = c("CLUSTER_ID" = "origin_id")
)
final = final  %>%
mutate(
area.x = area.x / 1000000,
distance_nh = distance_nh / 1000,
distance_sh = distance_sh / 1000,
network_nh = network_nh / 1000,
network_sh = network_sh / 1000,
circuity_nh = network_nh/distance_nh,
circuity_sh = network_sh/distance_sh
) %>%
select("CLUSTER_ID","area.x", "distance_nh", "distance_sh", "_sum",
"_mean", "network_nh", "network_sh", circuity_nh,circuity_sh )
final
str(final)
library(readr)
library(dplyr)
ntl_area <- read_csv("~/Desktop/Sattva/ntl and area.csv")
nh_distance <- read_csv("~/Desktop/Sattva/diatcne to nh.csv")
sh_distance <- read_csv("~/Desktop/Sattva/distance to sh.csv")
nh_network <- read_csv("~/Desktop/Sattva/nh_network.csv")
sh_network <- read_csv("~/Desktop/Sattva/sh_network.csv")
library(dplyr)
library(dplyr)
final <- ntl_area %>%
# 1. Join minimum NH distance (already has CLUSTER_ID)
left_join(
nh_distance %>%
group_by(CLUSTER_ID) %>%
slice_min(distance, n = 1, with_ties = FALSE) %>%
rename(distance_nh = distance),
by = "CLUSTER_ID"
) %>%
# 2. Join minimum SH distance (already has CLUSTER_ID)
left_join(
sh_distance %>%
group_by(CLUSTER_ID) %>%
slice_min(distance, n = 1, with_ties = FALSE) %>%
rename(distance_sh = distance),
by = "CLUSTER_ID"
) %>%
# 3. Join minimum NH network cost (using origin_id)
left_join(
nh_network %>%
group_by(origin_id) %>%
slice_min(total_cost, n = 1, with_ties = FALSE) %>%
rename(network_nh = total_cost),
by = c("CLUSTER_ID" = "origin_id")
) %>%
# 4. Join minimum SH network cost (using origin_id)
left_join(
sh_network %>%
group_by(origin_id) %>%
slice_min(total_cost, n = 1, with_ties = FALSE) %>%
rename(network_sh = total_cost),
by = c("CLUSTER_ID" = "origin_id")
)
final = final  %>%
mutate(
area.x = area.x / 1000000,
distance_nh = distance_nh / 1000,
distance_sh = distance_sh / 1000,
network_nh = network_nh / 1000,
network_sh = network_sh / 1000,
circuity_nh = network_nh/distance_nh,
circuity_sh = network_sh/distance_sh
) %>%
select("CLUSTER_ID","area.x", "distance_nh", "distance_sh", "_sum",
"_mean", "network_nh", "network_sh", circuity_nh,circuity_sh )
library(readr)
library(dplyr)
ntl_area <- read_csv("~/Desktop/Sattva/ntl and area.csv")
nh_distance <- read_csv("~/Desktop/Sattva/diatcne to nh.csv")
sh_distance <- read_csv("~/Desktop/Sattva/distance to sh.csv")
nh_network <- read_csv("~/Desktop/Sattva/nh_network.csv")
sh_network <- read_csv("~/Desktop/Sattva/sh_network.csv")
library(dplyr)
library(dplyr)
final <- ntl_area %>%
# 1. Join minimum NH distance (already has CLUSTER_ID)
left_join(
nh_distance %>%
group_by(CLUSTER_ID) %>%
slice_min(distance, n = 1, with_ties = FALSE) %>%
rename(distance_nh = distance),
by = "CLUSTER_ID"
) %>%
# 2. Join minimum SH distance (already has CLUSTER_ID)
left_join(
sh_distance %>%
group_by(CLUSTER_ID) %>%
slice_min(distance, n = 1, with_ties = FALSE) %>%
rename(distance_sh = distance),
by = "CLUSTER_ID"
) %>%
# 3. Join minimum NH network cost (using origin_id)
left_join(
nh_network %>%
group_by(origin_id) %>%
slice_min(total_cost, n = 1, with_ties = FALSE) %>%
rename(network_nh = total_cost),
by = c("CLUSTER_ID" = "origin_id")
) %>%
# 4. Join minimum SH network cost (using origin_id)
left_join(
sh_network %>%
group_by(origin_id) %>%
slice_min(total_cost, n = 1, with_ties = FALSE) %>%
rename(network_sh = total_cost),
by = c("CLUSTER_ID" = "origin_id")
)
final = final  %>%
mutate(
area.x = area.x / 1000000,
distance_nh = distance_nh / 1000,
distance_sh = distance_sh / 1000,
network_nh = network_nh / 1000,
network_sh = network_sh / 1000,
circuity_nh = network_nh/distance_nh,
circuity_sh = network_sh/distance_sh
) %>%
select("CLUSTER_ID","area.x", "distance_nh", "distance_sh", "_sum",
"_mean", "network_nh", "network_sh", circuity_nh,circuity_sh )
write.csv(final, "~/Desktop/Sattva/balaghat_indicators.csv")
library(readr)
library(dplyr)
ntl_area <- read_csv("~/Desktop/Sattva/ntl and area.csv")
nh_distance <- read_csv("~/Desktop/Sattva/diatcne to nh.csv")
sh_distance <- read_csv("~/Desktop/Sattva/distance to sh.csv")
nh_network <- read_csv("~/Desktop/Sattva/nh_network.csv")
sh_network <- read_csv("~/Desktop/Sattva/sh_network.csv")
library(dplyr)
library(dplyr)
final <- ntl_area %>%
# 1. Join minimum NH distance (already has CLUSTER_ID)
left_join(
nh_distance %>%
group_by(CLUSTER_ID) %>%
slice_min(distance, n = 1, with_ties = FALSE) %>%
rename(distance_nh = distance),
by = "CLUSTER_ID"
) %>%
# 2. Join minimum SH distance (already has CLUSTER_ID)
left_join(
sh_distance %>%
group_by(CLUSTER_ID) %>%
slice_min(distance, n = 1, with_ties = FALSE) %>%
rename(distance_sh = distance),
by = "CLUSTER_ID"
) %>%
# 3. Join minimum NH network cost (using origin_id)
left_join(
nh_network %>%
group_by(origin_id) %>%
slice_min(total_cost, n = 1, with_ties = FALSE) %>%
rename(network_nh = total_cost),
by = c("CLUSTER_ID" = "origin_id")
) %>%
# 4. Join minimum SH network cost (using origin_id)
left_join(
sh_network %>%
group_by(origin_id) %>%
slice_min(total_cost, n = 1, with_ties = FALSE) %>%
rename(network_sh = total_cost),
by = c("CLUSTER_ID" = "origin_id")
)
final = final %>%
mutate(
area.x = area.x / 1000000,
distance_nh = distance_nh / 1000,
distance_sh = distance_sh / 1000,
network_nh = network_nh / 1000,
network_sh = network_sh / 1000,
circuity_nh = network_nh / distance_nh,
circuity_sh = network_sh / distance_sh
) %>%
select("CLUSTER_ID", "area.x", "distance_nh", "distance_sh", "_sum",
"_mean", "network_nh", "network_sh", circuity_nh, circuity_sh) %>%
# Round all numeric columns to 2 decimals
mutate(across(where(is.numeric), \(x) round(x, 2)))
write.csv(final, "~/Desktop/Sattva/balaghat_indicators.csv")
paste0("cope_", c(2,7,10,12,14,17,23,25))
library(readr)
baseline_raw = read_csv("data_wrangling/baseline/baseline_raw.csv")
baseline_scoring = baseline_raw %>%
mutate(
depression = dass_3 + dass_5 + dass_10 + dass_13 + dass_16 + dass_17 + dass_21,
anxiety = dass_2 + dass_4 + dass_7 + dass_9 + dass_15 + dass_19 + dass_20,
stress = dass_1 + dass_6 + dass_8 + dass_11 + dass_12 + dass_14 + dass_18,
problem_cope = sum(paste0("cope_", c(2,7,10,12,14,17,23,25))),
emotion_cope = sum(paste0("cope_", c(5, 9, 13, 15, 18, 20, 21, 22, 24, 26, 27, 28))),
avoidant_cope = sum(paste0("cope_", c(1, 3, 4, 6, 8, 11, 16, 19))),
swls = sum(paste0("swls_", 1:5)),
social = sum(paste0("social_", 1:8)),
loneliness = sum(paste0("ucla_", 1:20)),
resilience = 18 - sum(paste0("brs_", 1:6)),
sleep_dur = ifelse(psq_4 >= 7, 0,
ifelse(psq_4 >= 6, 1
ifelse(psq_4 >= 5, 2, 3))),
library(readr)
baseline_raw = read_csv("data_wrangling/baseline/baseline_raw.csv")
baseline_scoring = baseline_raw %>%
mutate(
depression = dass_3 + dass_5 + dass_10 + dass_13 + dass_16 + dass_17 + dass_21,
anxiety = dass_2 + dass_4 + dass_7 + dass_9 + dass_15 + dass_19 + dass_20,
stress = dass_1 + dass_6 + dass_8 + dass_11 + dass_12 + dass_14 + dass_18,
problem_cope = sum(paste0("cope_", c(2,7,10,12,14,17,23,25))),
emotion_cope = sum(paste0("cope_", c(5, 9, 13, 15, 18, 20, 21, 22, 24, 26, 27, 28))),
avoidant_cope = sum(paste0("cope_", c(1, 3, 4, 6, 8, 11, 16, 19))),
swls = sum(paste0("swls_", 1:5)),
social = sum(paste0("social_", 1:8)),
loneliness = sum(paste0("ucla_", 1:20)),
resilience = 18 - sum(paste0("brs_", 1:6)),
sleep_dur = ifelse(psq_4 >= 7, 0,
ifelse(psq_4 >= 6, 1,
ifelse(psq_4 >= 5, 2, 3))),
sleep_dist = sum(paste0("psq_5.", 2:9)),
sleep_dist = ifelse(sleep_dist = 0, 0,
ifelse(sleep_dist <= 8, 1
ifelse(sleep_dist <= 16, 2, 3))),
library(readr)
baseline_raw = read_csv("data_wrangling/baseline/baseline_raw.csv")
baseline_scoring = baseline_raw %>%
mutate(
depression = dass_3 + dass_5 + dass_10 + dass_13 + dass_16 + dass_17 + dass_21,
anxiety = dass_2 + dass_4 + dass_7 + dass_9 + dass_15 + dass_19 + dass_20,
stress = dass_1 + dass_6 + dass_8 + dass_11 + dass_12 + dass_14 + dass_18,
problem_cope = sum(paste0("cope_", c(2,7,10,12,14,17,23,25))),
emotion_cope = sum(paste0("cope_", c(5, 9, 13, 15, 18, 20, 21, 22, 24, 26, 27, 28))),
avoidant_cope = sum(paste0("cope_", c(1, 3, 4, 6, 8, 11, 16, 19))),
swls = sum(paste0("swls_", 1:5)),
social = sum(paste0("social_", 1:8)),
loneliness = sum(paste0("ucla_", 1:20)),
resilience = 18 - sum(paste0("brs_", 1:6)),
sleep_dur = ifelse(psq_4 >= 7, 0,
ifelse(psq_4 >= 6, 1,
ifelse(psq_4 >= 5, 2, 3))),
sleep_dist = sum(paste0("psq_5.", 2:9)),
sleep_dist = ifelse(sleep_dist = 0, 0,
ifelse(sleep_dist <= 8, 1,
ifelse(sleep_dist <= 16, 2, 3))),
sleep_lat = ifelse(psq_2 <= 15, 0,
ifelse(psq_2 <= 30, 1,
ifelse(psq_2 <= 60, 2, 3))),
sleep_lat = ifelse((sleep_lat +psq_5.1) <= 15, 0,
ifelse((sleep_lat +psq_5.1)<= 30, 1,
ifelse((sleep_lat +psq_5.1) <= 60, 2, 3)))
)
library(readr)
baseline_raw = read_csv("data_wrangling/baseline/baseline_raw.csv")
baseline_scoring = baseline_raw %>%
mutate(
depression = dass_3 + dass_5 + dass_10 + dass_13 + dass_16 + dass_17 + dass_21,
anxiety = dass_2 + dass_4 + dass_7 + dass_9 + dass_15 + dass_19 + dass_20,
stress = dass_1 + dass_6 + dass_8 + dass_11 + dass_12 + dass_14 + dass_18,
problem_cope = sum(pick(paste0("cope_", c(2,7,10,12,14,17,23,25)))),
emotion_cope = sum(pick(paste0("cope_", c(5, 9, 13, 15, 18, 20, 21, 22, 24, 26, 27, 28))),
avoidant_cope = sum(pick(paste0("cope_", c(1, 3, 4, 6, 8, 11, 16, 19))),
swls = sum(pick(paste0("swls_", 1:5))),
social = sum(pick(paste0("social_", 1:8))),
loneliness = sum(pick(paste0("ucla_", 1:20))),
resilience = 18 - sum(pick(paste0("brs_", 1:6)),
sleep_dur = ifelse(psq_4 >= 7, 0,
ifelse(psq_4 >= 6, 1,
ifelse(psq_4 >= 5, 2, 3))),
sleep_dist = sum(paste0("psq_5.", 2:9)),
sleep_dist = ifelse(sleep_dist = 0, 0,
ifelse(sleep_dist <= 8, 1,
ifelse(sleep_dist <= 16, 2, 3))),
sleep_lat = ifelse(psq_2 <= 15, 0,
ifelse(psq_2 <= 30, 1,
ifelse(psq_2 <= 60, 2, 3))),
sleep_lat = ifelse((sleep_lat +psq_5.1) <= 15, 0,
ifelse((sleep_lat +psq_5.1)<= 30, 1,
ifelse((sleep_lat +psq_5.1) <= 60, 2, 3)))
)
)
library(readr)
baseline_raw = read_csv("data_wrangling/baseline/baseline_raw.csv")
baseline_scoring = baseline_raw %>%
mutate(
depression = dass_3 + dass_5 + dass_10 + dass_13 + dass_16 + dass_17 + dass_21,
anxiety = dass_2 + dass_4 + dass_7 + dass_9 + dass_15 + dass_19 + dass_20,
stress = dass_1 + dass_6 + dass_8 + dass_11 + dass_12 + dass_14 + dass_18,
problem_cope = sum(pick(paste0("cope_", c(2,7,10,12,14,17,23,25)))),
emotion_cope = sum(pick(paste0("cope_", c(5, 9, 13, 15, 18, 20, 21, 22, 24, 26, 27, 28))),
avoidant_cope = sum(pick(paste0("cope_", c(1, 3, 4, 6, 8, 11, 16, 19))),
swls = sum(pick(paste0("swls_", 1:5))),
social = sum(pick(paste0("social_", 1:8))),
loneliness = sum(pick(paste0("ucla_", 1:20))),
resilience = 18 - sum(pick(paste0("brs_", 1:6))),
sleep_dur = ifelse(psq_4 >= 7, 0,
ifelse(psq_4 >= 6, 1,
ifelse(psq_4 >= 5, 2, 3))),
sleep_dist = sum(paste0("psq_5.", 2:9)),
sleep_dist = ifelse(sleep_dist = 0, 0,
ifelse(sleep_dist <= 8, 1,
ifelse(sleep_dist <= 16, 2, 3))),
sleep_lat = ifelse(psq_2 <= 15, 0,
ifelse(psq_2 <= 30, 1,
ifelse(psq_2 <= 60, 2, 3))),
sleep_lat = ifelse((sleep_lat +psq_5.1) <= 15, 0,
ifelse((sleep_lat +psq_5.1)<= 30, 1,
ifelse((sleep_lat +psq_5.1) <= 60, 2, 3)))
)
library(readr)
baseline_raw = read_csv("data_wrangling/baseline/baseline_raw.csv")
baseline_scoring = baseline_raw %>%
mutate(
depression = dass_3 + dass_5 + dass_10 + dass_13 + dass_16 + dass_17 + dass_21,
anxiety = dass_2 + dass_4 + dass_7 + dass_9 + dass_15 + dass_19 + dass_20,
stress = dass_1 + dass_6 + dass_8 + dass_11 + dass_12 + dass_14 + dass_18,
problem_cope = sum(pick(paste0("cope_", c(2,7,10,12,14,17,23,25)))),
emotion_cope = sum(pick(paste0("cope_", c(5, 9, 13, 15, 18, 20, 21, 22, 24, 26, 27, 28))),
avoidant_cope = sum(pick(paste0("cope_", c(1, 3, 4, 6, 8, 11, 16, 19))),
swls = sum(pick(paste0("swls_", 1:5))),
social = sum(pick(paste0("social_", 1:8))),
loneliness = sum(pick(paste0("ucla_", 1:20))),
resilience = 18 - sum(pick(paste0("brs_", 1:6))),
sleep_dur = ifelse(psq_4 >= 7, 0,
ifelse(psq_4 >= 6, 1,
ifelse(psq_4 >= 5, 2, 3))),
sleep_dist = sum(pick(paste0("psq_5.", 2:9))),
sleep_dist = ifelse(sleep_dist = 0, 0,
ifelse(sleep_dist <= 8, 1,
ifelse(sleep_dist <= 16, 2, 3))),
sleep_lat = ifelse(psq_2 <= 15, 0,
ifelse(psq_2 <= 30, 1,
ifelse(psq_2 <= 60, 2, 3))),
sleep_lat = ifelse((sleep_lat +psq_5.1) <= 15, 0,
ifelse((sleep_lat +psq_5.1)<= 30, 1,
ifelse((sleep_lat +psq_5.1) <= 60, 2, 3)))
)
baseline_scoring = baseline_raw %>%
mutate(
depression = dass_3 + dass_5 + dass_10 + dass_13 + dass_16 + dass_17 + dass_21,
anxiety = dass_2 + dass_4 + dass_7 + dass_9 + dass_15 + dass_19 + dass_20,
stress = dass_1 + dass_6 + dass_8 + dass_11 + dass_12 + dass_14 + dass_18,
problem_cope = sum(pick(paste0("cope_", c(2,7,10,12,14,17,23,25)))),
emotion_cope = sum(pick(paste0("cope_", c(5, 9, 13, 15, 18, 20, 21, 22, 24, 26, 27, 28)))),
avoidant_cope = sum(pick(paste0("cope_", c(1, 3, 4, 6, 8, 11, 16, 19)))),
swls = sum(pick(paste0("swls_", 1:5))),
social = sum(pick(paste0("social_", 1:8))),
loneliness = sum(pick(paste0("ucla_", 1:20))),
resilience = 18 - sum(pick(paste0("brs_", 1:6))),
sleep_dur = ifelse(psq_4 >= 7, 0,
ifelse(psq_4 >= 6, 1,
ifelse(psq_4 >= 5, 2, 3))),
sleep_dist = sum(pick(paste0("psq_5.", 2:9))),
sleep_dist = ifelse(sleep_dist = 0, 0,
ifelse(sleep_dist <= 8, 1,
ifelse(sleep_dist <= 16, 2, 3))),
sleep_lat = ifelse(psq_2 <= 15, 0,
ifelse(psq_2 <= 30, 1,
ifelse(psq_2 <= 60, 2, 3))),
sleep_lat = ifelse((sleep_lat +psq_5.1) <= 15, 0,
ifelse((sleep_lat +psq_5.1)<= 30, 1,
ifelse((sleep_lat +psq_5.1) <= 60, 2, 3)))
)
library(readr)
baseline_raw = read_csv("data_wrangling/baseline/baseline_raw.csv")
baseline_scoring = baseline_raw %>%
mutate(
depression = dass_3 + dass_5 + dass_10 + dass_13 + dass_16 + dass_17 + dass_21,
anxiety = dass_2 + dass_4 + dass_7 + dass_9 + dass_15 + dass_19 + dass_20,
stress = dass_1 + dass_6 + dass_8 + dass_11 + dass_12 + dass_14 + dass_18,
problem_cope = sum(pick(paste0("cope_", c(2,7,10,12,14,17,23,25)))),
emotion_cope = sum(pick(paste0("cope_", c(5, 9, 13, 15, 18, 20, 21, 22, 24, 26, 27, 28)))),
avoidant_cope = sum(pick(paste0("cope_", c(1, 3, 4, 6, 8, 11, 16, 19)))),
swls = sum(pick(paste0("swls_", 1:5))),
social = sum(pick(paste0("social_", 1:8))),
loneliness = sum(pick(paste0("ucla_", 1:20))),
resilience = 18 - sum(pick(paste0("brs_", 1:6))),
sleep_dur = ifelse(psq_4 >= 7, 0,
ifelse(psq_4 >= 6, 1,
ifelse(psq_4 >= 5, 2, 3))),
sleep_dist = sum(pick(paste0("psq_5.", 2:9))),
sleep_dist = ifelse(sleep_dist == 0, 0,
ifelse(sleep_dist <= 8, 1,
ifelse(sleep_dist <= 16, 2, 3))),
sleep_lat = ifelse(psq_2 <= 15, 0,
ifelse(psq_2 <= 30, 1,
ifelse(psq_2 <= 60, 2, 3))),
sleep_lat = ifelse((sleep_lat +psq_5.1) <= 15, 0,
ifelse((sleep_lat +psq_5.1)<= 30, 1,
ifelse((sleep_lat +psq_5.1) <= 60, 2, 3)))
)
View(baseline_scoring)
View(baseline_scoring)
baseline_raw %>%
mutate(problem_cope = sum(pick(paste0("cope_", c(2,7,10,12,14,17,23,25)))))  %>%
select(problem_cope)
pick(paste0("cope_", c(2,7,10,12,14,17,23,25)))
baseline_raw %>%
mutate(problem_cope = sum(pick(paste0("cope_", c(2,7,10,12,14,17,23,25)))))  %>%
select(problem_cope)
library(readr)
baseline_raw = read_csv("data_wrangling/baseline/baseline_raw.csv")
baseline_scoring = baseline_raw %>%
mutate(
depression = dass_3 + dass_5 + dass_10 + dass_13 + dass_16 + dass_17 + dass_21,
anxiety = dass_2 + dass_4 + dass_7 + dass_9 + dass_15 + dass_19 + dass_20,
stress = dass_1 + dass_6 + dass_8 + dass_11 + dass_12 + dass_14 + dass_18,
problem_cope = rowSums(pick(paste0("cope_", c(2,7,10,12,14,17,23,25)))),
emotion_cope = rowSums(pick(paste0("cope_", c(5, 9, 13, 15, 18, 20, 21, 22, 24, 26, 27, 28)))),
avoidant_cope = rowSums(pick(paste0("cope_", c(1, 3, 4, 6, 8, 11, 16, 19)))),
swls = rowSums(pick(paste0("swls_", 1:5))),
social = rowSums(pick(paste0("social_", 1:8))),
loneliness = rowSums(pick(paste0("ucla_", 1:20))),
resilience = 18 - rowSums(pick(paste0("brs_", 1:6))),
sleep_dur = ifelse(psq_4 >= 7, 0,
ifelse(psq_4 >= 6, 1,
ifelse(psq_4 >= 5, 2, 3))),
sleep_dist = rowSums(pick(paste0("psq_5.", 2:9))),
sleep_dist = ifelse(sleep_dist == 0, 0,
ifelse(sleep_dist <= 8, 1,
ifelse(sleep_dist <= 16, 2, 3))),
sleep_lat = ifelse(psq_2 <= 15, 0,
ifelse(psq_2 <= 30, 1,
ifelse(psq_2 <= 60, 2, 3))),
sleep_lat = ifelse((sleep_lat +psq_5.1) <= 15, 0,
ifelse((sleep_lat +psq_5.1)<= 30, 1,
ifelse((sleep_lat +psq_5.1) <= 60, 2, 3)))
)
baseline_raw %>%
mutate(problem_cope = sum(pick(paste0("cope_", c(2,7,10,12,14,17,23,25)))))  %>%
select(problem_cope)
library(readr)
library(dplyr)
ntl_area <- read_csv("~/Desktop/Sattva/ntl and area.csv")
nh_distance <- read_csv("~/Desktop/Sattva/diatcne to nh.csv")
sh_distance <- read_csv("~/Desktop/Sattva/distance to sh.csv")
nh_network <- read_csv("~/Desktop/Sattva/nh_network.csv")
sh_network <- read_csv("~/Desktop/Sattva/sh_network.csv")
library(dplyr)
library(dplyr)
final <- ntl_area %>%
# 1. Join minimum NH distance (already has CLUSTER_ID)
left_join(
nh_distance %>%
group_by(CLUSTER_ID) %>%
slice_min(distance, n = 1, with_ties = FALSE) %>%
rename(distance_nh = distance),
by = "CLUSTER_ID"
) %>%
# 2. Join minimum SH distance (already has CLUSTER_ID)
left_join(
sh_distance %>%
group_by(CLUSTER_ID) %>%
slice_min(distance, n = 1, with_ties = FALSE) %>%
rename(distance_sh = distance),
by = "CLUSTER_ID"
) %>%
# 3. Join minimum NH network cost (using origin_id)
left_join(
nh_network %>%
group_by(origin_id) %>%
slice_min(total_cost, n = 1, with_ties = FALSE) %>%
rename(network_nh = total_cost),
by = c("CLUSTER_ID" = "origin_id")
) %>%
# 4. Join minimum SH network cost (using origin_id)
left_join(
sh_network %>%
group_by(origin_id) %>%
slice_min(total_cost, n = 1, with_ties = FALSE) %>%
rename(network_sh = total_cost),
by = c("CLUSTER_ID" = "origin_id")
)
final = final %>%
mutate(
area.x = area.x / 1000000,
distance_nh = distance_nh / 1000,
distance_sh = distance_sh / 1000,
network_nh = network_nh / 1000,
network_sh = network_sh / 1000,
circuity_nh = network_nh / distance_nh,
circuity_sh = network_sh / distance_sh
) %>%
select("CLUSTER_ID", "area.x", "distance_nh", "distance_sh", "_sum",
"_mean", "network_nh", "network_sh", circuity_nh, circuity_sh) %>%
# Round all numeric columns to 2 decimals
mutate(across(where(is.numeric), \(x) round(x, 2)))
write.csv(final, "~/Desktop/Sattva/balaghat_indicators.csv")
